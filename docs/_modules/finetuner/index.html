<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" />
        <link rel="canonical" href="https://finetuner.jina.ai/_modules/finetuner.html" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>finetuner - Finetuner documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: #4d4d4d;
  --color-brand-primary: #009191;
  --color-brand-content: #009191;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../../">
                <div class="brand">Finetuner  documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">
            
            <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/logo-light.svg" alt="Light Logo" />
    <img class="sidebar-logo only-dark" src="../../_static/logo-dark.svg" alt="Dark Logo" />
  </div>
  
  
</a>
<div class="sd-d-flex-row sd-align-major-spaced">
  <a class="github-button" href="https://github.com/jina-ai/finetuner" data-icon="octicon-star" data-show-count="true" aria-label="Star jina-ai/jina on GitHub" style="opacity: 0;">Star</a>
  
</div><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
    <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/how-it-works/"><svg aria-hidden="true" class="sd-octicon sd-octicon-question" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm9 3a1 1 0 11-2 0 1 1 0 012 0zM6.92 6.085c.081-.16.19-.299.34-.398.145-.097.371-.187.74-.187.28 0 .553.087.738.225A.613.613 0 019 6.25c0 .177-.04.264-.077.318a.956.956 0 01-.277.245c-.076.051-.158.1-.258.161l-.007.004a7.728 7.728 0 00-.313.195 2.416 2.416 0 00-.692.661.75.75 0 001.248.832.956.956 0 01.276-.245 6.3 6.3 0 01.26-.16l.006-.004c.093-.057.204-.123.313-.195.222-.149.487-.355.692-.662.214-.32.329-.702.329-1.15 0-.76-.36-1.348-.863-1.725A2.76 2.76 0 008 4c-.631 0-1.155.16-1.572.438-.413.276-.68.638-.849.977a.75.75 0 101.342.67z" fill-rule="evenodd"></path></svg> How Does it Work?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/installation/"><svg aria-hidden="true" class="sd-octicon sd-octicon-desktop-download" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4.927 5.427l2.896 2.896a.25.25 0 00.354 0l2.896-2.896A.25.25 0 0010.896 5H8.75V.75a.75.75 0 10-1.5 0V5H5.104a.25.25 0 00-.177.427z"></path><path d="M1.573 2.573a.25.25 0 00-.073.177v7.5a.25.25 0 00.25.25h12.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-3a.75.75 0 110-1.5h3A1.75 1.75 0 0116 2.75v7.5A1.75 1.75 0 0114.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0111.25 16h-6.5a.75.75 0 01-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 010 10.25v-7.5A1.75 1.75 0 011.75 1h3a.75.75 0 010 1.5h-3a.25.25 0 00-.177.073zM6.982 12a5.72 5.72 0 01-.765 2.5h3.566a5.72 5.72 0 01-.765-2.5H6.982z"></path></svg> Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../walkthrough/"><svg aria-hidden="true" class="sd-octicon sd-octicon-list-ordered" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M2.003 2.5a.5.5 0 00-.723-.447l-1.003.5a.5.5 0 00.446.895l.28-.14V6H.5a.5.5 0 000 1h2.006a.5.5 0 100-1h-.503V2.5zM5 3.25a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5h-8.5A.75.75 0 015 3.25zm0 5a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5h-8.5A.75.75 0 015 8.25zm0 5a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5h-8.5a.75.75 0 01-.75-.75zM.924 10.32l.003-.004a.851.851 0 01.144-.153A.66.66 0 011.5 10c.195 0 .306.068.374.146a.57.57 0 01.128.376c0 .453-.269.682-.8 1.078l-.035.025C.692 11.98 0 12.495 0 13.5a.5.5 0 00.5.5h2.003a.5.5 0 000-1H1.146c.132-.197.351-.372.654-.597l.047-.035c.47-.35 1.156-.858 1.156-1.845 0-.365-.118-.744-.377-1.038-.268-.303-.658-.484-1.126-.484-.48 0-.84.202-1.068.392a1.858 1.858 0 00-.348.384l-.007.011-.002.004-.001.002-.001.001a.5.5 0 00.851.525zM.5 10.055l-.427-.26.427.26z" fill-rule="evenodd"></path></svg> Walkthrough</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/basic-concepts/">Basic Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/login/">Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/create-training-data/">Prepare Training Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/choose-backbone/">Backbone Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/run-job/">Run Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/save-model/">Save Artifact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../walkthrough/inference/">Inference</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/budget/"><svg aria-hidden="true" class="sd-octicon sd-octicon-database" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M2.5 3.5c0-.133.058-.318.282-.55.227-.237.592-.484 1.1-.708C4.899 1.795 6.354 1.5 8 1.5c1.647 0 3.102.295 4.117.742.51.224.874.47 1.101.707.224.233.282.418.282.551 0 .133-.058.318-.282.55-.227.237-.592.484-1.1.708C11.101 5.205 9.646 5.5 8 5.5c-1.647 0-3.102-.295-4.117-.742-.51-.224-.874-.47-1.101-.707-.224-.233-.282-.418-.282-.551zM1 3.5c0-.626.292-1.165.7-1.59.406-.422.956-.767 1.579-1.041C4.525.32 6.195 0 8 0c1.805 0 3.475.32 4.722.869.622.274 1.172.62 1.578 1.04.408.426.7.965.7 1.591v9c0 .626-.292 1.165-.7 1.59-.406.422-.956.767-1.579 1.041C11.476 15.68 9.806 16 8 16c-1.805 0-3.475-.32-4.721-.869-.623-.274-1.173-.62-1.579-1.04-.408-.426-.7-.965-.7-1.591v-9zM2.5 8V5.724c.241.15.503.286.779.407C4.525 6.68 6.195 7 8 7c1.805 0 3.475-.32 4.722-.869.275-.121.537-.257.778-.407V8c0 .133-.058.318-.282.55-.227.237-.592.484-1.1.708C11.101 9.705 9.646 10 8 10c-1.647 0-3.102-.295-4.117-.742-.51-.224-.874-.47-1.101-.707C2.558 8.318 2.5 8.133 2.5 8zm0 2.225V12.5c0 .133.058.318.282.55.227.237.592.484 1.1.708 1.016.447 2.471.742 4.118.742 1.647 0 3.102-.295 4.117-.742.51-.224.874-.47 1.101-.707.224-.233.282-.418.282-.551v-2.275c-.241.15-.503.285-.778.406-1.247.549-2.917.869-4.722.869-1.805 0-3.475-.32-4.721-.869a6.236 6.236 0 01-.779-.406z" fill-rule="evenodd"></path></svg> How much data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/negative-mining/"><svg aria-hidden="true" class="sd-octicon sd-octicon-telescope" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M14.184 1.143a1.75 1.75 0 00-2.502-.57L.912 7.916a1.75 1.75 0 00-.53 2.32l.447.775a1.75 1.75 0 002.275.702l11.745-5.656a1.75 1.75 0 00.757-2.451l-1.422-2.464zm-1.657.669a.25.25 0 01.358.081l1.422 2.464a.25.25 0 01-.108.35l-2.016.97-1.505-2.605 1.85-1.26zM9.436 3.92l1.391 2.41-5.42 2.61-.942-1.63 4.97-3.39zM3.222 8.157l-1.466 1a.25.25 0 00-.075.33l.447.775a.25.25 0 00.325.1l1.598-.769-.83-1.436zm6.253 2.306a.75.75 0 00-.944-.252l-1.809.87a.75.75 0 00-.293.253L4.38 14.326a.75.75 0 101.238.848l1.881-2.75v2.826a.75.75 0 001.5 0v-2.826l1.881 2.75a.75.75 0 001.238-.848l-2.644-3.863z" fill-rule="evenodd"></path></svg> Negative Mining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/using-callbacks/"><svg aria-hidden="true" class="sd-octicon sd-octicon-link" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z" fill-rule="evenodd"></path></svg> Using Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/linear-probe/"><svg aria-hidden="true" class="sd-octicon sd-octicon-pin" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4.456.734a1.75 1.75 0 012.826.504l.613 1.327a3.081 3.081 0 002.084 1.707l2.454.584c1.332.317 1.8 1.972.832 2.94L11.06 10l3.72 3.72a.75.75 0 11-1.061 1.06L10 11.06l-2.204 2.205c-.968.968-2.623.5-2.94-.832l-.584-2.454a3.081 3.081 0 00-1.707-2.084l-1.327-.613a1.75 1.75 0 01-.504-2.826L4.456.734zM5.92 1.866a.25.25 0 00-.404-.072L1.794 5.516a.25.25 0 00.072.404l1.328.613A4.582 4.582 0 015.73 9.63l.584 2.454a.25.25 0 00.42.12l5.47-5.47a.25.25 0 00-.12-.42L9.63 5.73a4.581 4.581 0 01-3.098-2.537L5.92 1.866z" fill-rule="evenodd"></path></svg> Projection Head</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/advanced-losses-optimizers-and-poolers/"><svg aria-hidden="true" class="sd-octicon sd-octicon-mortar-board" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.693 1.066a.75.75 0 01.614 0l7.25 3.25a.75.75 0 010 1.368L13 6.831v2.794c0 1.024-.81 1.749-1.66 2.173-.893.447-2.075.702-3.34.702-.278 0-.55-.012-.816-.036a.75.75 0 01.133-1.494c.22.02.45.03.683.03 1.082 0 2.025-.221 2.67-.543.69-.345.83-.682.83-.832V7.503L8.307 8.934a.75.75 0 01-.614 0L4 7.28v1.663c.296.105.575.275.812.512.438.438.688 1.059.688 1.796v3a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-3c0-.737.25-1.358.688-1.796.237-.237.516-.407.812-.512V6.606L.443 5.684a.75.75 0 010-1.368l7.25-3.25zM2.583 5L8 7.428 13.416 5 8 2.572 2.583 5zM2.5 11.25c0-.388.125-.611.25-.735a.704.704 0 01.5-.203c.19 0 .37.071.5.203.125.124.25.347.25.735v2.25H2.5v-2.25z" fill-rule="evenodd"></path></svg> Advanced loss functions, optimizers and poolers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced-topics/finetuner-executor/"><svg aria-hidden="true" class="sd-octicon sd-octicon-gear" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.429 1.525a6.593 6.593 0 011.142 0c.036.003.108.036.137.146l.289 1.105c.147.56.55.967.997 1.189.174.086.341.183.501.29.417.278.97.423 1.53.27l1.102-.303c.11-.03.175.016.195.046.219.31.41.641.573.989.014.031.022.11-.059.19l-.815.806c-.411.406-.562.957-.53 1.456a4.588 4.588 0 010 .582c-.032.499.119 1.05.53 1.456l.815.806c.08.08.073.159.059.19a6.494 6.494 0 01-.573.99c-.02.029-.086.074-.195.045l-1.103-.303c-.559-.153-1.112-.008-1.529.27-.16.107-.327.204-.5.29-.449.222-.851.628-.998 1.189l-.289 1.105c-.029.11-.101.143-.137.146a6.613 6.613 0 01-1.142 0c-.036-.003-.108-.037-.137-.146l-.289-1.105c-.147-.56-.55-.967-.997-1.189a4.502 4.502 0 01-.501-.29c-.417-.278-.97-.423-1.53-.27l-1.102.303c-.11.03-.175-.016-.195-.046a6.492 6.492 0 01-.573-.989c-.014-.031-.022-.11.059-.19l.815-.806c.411-.406.562-.957.53-1.456a4.587 4.587 0 010-.582c.032-.499-.119-1.05-.53-1.456l-.815-.806c-.08-.08-.073-.159-.059-.19a6.44 6.44 0 01.573-.99c.02-.029.086-.075.195-.045l1.103.303c.559.153 1.112.008 1.529-.27.16-.107.327-.204.5-.29.449-.222.851-.628.998-1.189l.289-1.105c.029-.11.101-.143.137-.146zM8 0c-.236 0-.47.01-.701.03-.743.065-1.29.615-1.458 1.261l-.29 1.106c-.017.066-.078.158-.211.224a5.994 5.994 0 00-.668.386c-.123.082-.233.09-.3.071L3.27 2.776c-.644-.177-1.392.02-1.82.63a7.977 7.977 0 00-.704 1.217c-.315.675-.111 1.422.363 1.891l.815.806c.05.048.098.147.088.294a6.084 6.084 0 000 .772c.01.147-.038.246-.088.294l-.815.806c-.474.469-.678 1.216-.363 1.891.2.428.436.835.704 1.218.428.609 1.176.806 1.82.63l1.103-.303c.066-.019.176-.011.299.071.213.143.436.272.668.386.133.066.194.158.212.224l.289 1.106c.169.646.715 1.196 1.458 1.26a8.094 8.094 0 001.402 0c.743-.064 1.29-.614 1.458-1.26l.29-1.106c.017-.066.078-.158.211-.224a5.98 5.98 0 00.668-.386c.123-.082.233-.09.3-.071l1.102.302c.644.177 1.392-.02 1.82-.63.268-.382.505-.789.704-1.217.315-.675.111-1.422-.364-1.891l-.814-.806c-.05-.048-.098-.147-.088-.294a6.1 6.1 0 000-.772c-.01-.147.039-.246.088-.294l.814-.806c.475-.469.679-1.216.364-1.891a7.992 7.992 0 00-.704-1.218c-.428-.609-1.176-.806-1.82-.63l-1.103.303c-.066.019-.176.011-.299-.071a5.991 5.991 0 00-.668-.386c-.133-.066-.194-.158-.212-.224L10.16 1.29C9.99.645 9.444.095 8.701.031A8.094 8.094 0 008 0zm1.5 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM11 8a3 3 0 11-6 0 3 3 0 016 0z" fill-rule="evenodd"></path></svg> Use FinetunerExecutor inside a Jina Flow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finetuning Tasks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/text_to_text/">Text-to-Text Search via BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/image_to_image/">Image-to-Image Search with TripletMarginLoss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/image_to_image_arcface/">Image-to-Image Search with ArcFaceLoss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/text_to_image/">Text-to-Image Search via CLIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/multilingual_text_to_image/">Multilingual Text-to-Image Search with MultilingualCLIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/mesh_to_mesh/">3D Mesh-to-3D Mesh Search via PointNet++</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api-rst/"><span class="fab fa-python"></span> Python API</a></li>
</ul>

    <p class="caption" role="heading"><span class="caption-text">Ecosystem</span></p>
    <ul>
        <li class="toctree-l1">
            <a class="reference external" href="https://docs.jina.ai">
                <img class="sidebar-ecosys-logo only-light-line" src="../../_static/search-light.svg">
                <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/search-dark.svg">
                Jina</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://cloud.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/hub-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/hub-dark.svg">
            Jina Hub</a></li>
        <li class="toctree-l1"><a class="reference internal" href="#">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/finetuner-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/finetuner-dark.svg">
            Finetuner</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://docarray.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/docarray-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/docarray-dark.svg">
            DocArray</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://clip-as-service.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/cas-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/cas-dark.svg">
            CLIP-as-service</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/jcloud">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/JCloud-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/JCloud-dark.svg">
            JCloud</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/now">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/now-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/now-dark.svg">
            NOW</a></li>
    </ul>
</div>
</div>

            </div>
            
        </div>
    </aside>
    <div class="main">
        <div class="content">
            <div class="article-container">
                <a href="#" class="back-to-top muted-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
                    </svg>
                    <span>Back to top</span>
                </a>
                <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon no-toc"
                           for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <article role="main">
                    <h1>Source code for finetuner</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">_finetuner.runner.stubs</span> <span class="kn">import</span> <span class="n">model</span> <span class="k">as</span> <span class="n">model_stub</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">DocumentArray</span>

<span class="kn">from</span> <span class="nn">finetuner.constants</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DEFAULT_FINETUNER_HOST</span><span class="p">,</span>
    <span class="n">DEFAULT_HUBBLE_REGISTRY</span><span class="p">,</span>
    <span class="n">HOST</span><span class="p">,</span>
    <span class="n">HUBBLE_REGISTRY</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">finetuner.data</span> <span class="kn">import</span> <span class="n">CSVOptions</span>
<span class="kn">from</span> <span class="nn">finetuner.run</span> <span class="kn">import</span> <span class="n">Run</span>
<span class="kn">from</span> <span class="nn">hubble</span> <span class="kn">import</span> <span class="n">login_required</span>

<span class="k">if</span> <span class="n">HOST</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">HOST</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_FINETUNER_HOST</span>

<span class="k">if</span> <span class="n">HUBBLE_REGISTRY</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">HUBBLE_REGISTRY</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_HUBBLE_REGISTRY</span>

<span class="kn">from</span> <span class="nn">finetuner</span> <span class="kn">import</span> <span class="n">callback</span><span class="p">,</span> <span class="n">model</span>
<span class="kn">from</span> <span class="nn">finetuner.console</span> <span class="kn">import</span> <span class="n">print_model_table</span>
<span class="kn">from</span> <span class="nn">finetuner.data</span> <span class="kn">import</span> <span class="n">build_encoding_dataset</span>
<span class="kn">from</span> <span class="nn">finetuner.experiment</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">finetuner.finetuner</span> <span class="kn">import</span> <span class="n">Finetuner</span>
<span class="kn">from</span> <span class="nn">finetuner.model</span> <span class="kn">import</span> <span class="n">list_model_classes</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">_finetuner.models.inference</span> <span class="kn">import</span> <span class="n">InferenceEngine</span>

<span class="n">ft</span> <span class="o">=</span> <span class="n">Finetuner</span><span class="p">()</span>


<div class="viewcode-block" id="login"><a class="viewcode-back" href="../../api/finetuner/#finetuner.login">[docs]</a><span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">interactive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Login to Jina AI Cloud to use cloud-based fine-tuning.</span>
<span class="sd">    Thereby, an authentication token is</span>
<span class="sd">    generated which can be read with the :func:`~finetuner.get_token` function.</span>

<span class="sd">    :param force: If set to true, an existing token will be overwritten. Otherwise,</span>
<span class="sd">        you will not login again, if a valid token already exists.</span>
<span class="sd">    :param interactive: Interactive mode should be set in Jupyter environments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="n">interactive</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_callbacks"><a class="viewcode-back" href="../../api/finetuner/#finetuner.list_callbacks">[docs]</a><span class="k">def</span> <span class="nf">list_callbacks</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="o">.</span><span class="n">CallbackStubType</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List available callbacks.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">obj</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="p">}</span></div>


<span class="k">def</span> <span class="nf">_build_name_stub_map</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">model_stub</span><span class="o">.</span><span class="n">ModelStubType</span><span class="p">]:</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">members</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">model_stub</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">stub</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;MLPStub&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">stub</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">:</span>
            <span class="n">rv</span><span class="p">[</span><span class="n">stub</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">stub</span>
    <span class="k">return</span> <span class="n">rv</span>


<div class="viewcode-block" id="list_models"><a class="viewcode-back" href="../../api/finetuner/#finetuner.list_models">[docs]</a><span class="k">def</span> <span class="nf">list_models</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List available models.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">list_model_classes</span><span class="p">()]</span></div>


<div class="viewcode-block" id="list_model_options"><a class="viewcode-back" href="../../api/finetuner/#finetuner.list_model_options">[docs]</a><span class="k">def</span> <span class="nf">list_model_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List available options per model.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">parameter</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span>
                <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span> <span class="o">==</span> <span class="n">parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">,</span>
                <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">parameter</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span> <span class="o">!=</span> <span class="n">parameter</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="p">),</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                <span class="n">_model_class</span><span class="o">.</span><span class="fm">__init__</span>
            <span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;self&#39;</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_model_class</span> <span class="ow">in</span> <span class="n">list_model_classes</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span></div>


<div class="viewcode-block" id="describe_models"><a class="viewcode-back" href="../../api/finetuner/#finetuner.describe_models">[docs]</a><span class="k">def</span> <span class="nf">describe_models</span><span class="p">(</span><span class="n">task</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print model information, such as name, task, output dimension, architecture</span>
<span class="sd">    and description as a table.</span>

<span class="sd">    :param task: The task for the backbone model, one of `text-to-text`,</span>
<span class="sd">        `text-to-image`, `image-to-image`. If not provided, will print all backbone</span>
<span class="sd">        models.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">print_model_table</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">)</span></div>


<span class="nd">@login_required</span>
<span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">train_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">],</span>
    <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">val_split</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">model_artifact</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">loss</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;TripletMarginLoss&#39;</span><span class="p">,</span>
    <span class="n">miner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">miner_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Adam&#39;</span><span class="p">,</span>
    <span class="n">optimizer_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">callback</span><span class="o">.</span><span class="n">CallbackStubType</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">scheduler_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">freeze</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">to_onnx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">csv_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">CSVOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">public</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">num_items_per_class</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">sampler</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">loss_optimizer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">loss_optimizer_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Run</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Finetuner :class:`Run`, calling this function will submit a fine-tuning</span>
<span class="sd">    job to the Jina AI Cloud.</span>

<span class="sd">    :param model: The name of model to be fine-tuned. Run `finetuner.list_models()` or</span>
<span class="sd">        `finetuner.describe_models()` to see the available model names.</span>
<span class="sd">    :param train_data: Either a `DocumentArray` for training data, a name of the</span>
<span class="sd">        `DocumentArray` that is pushed on Jina AI Cloud or a path to a CSV file.</span>
<span class="sd">    :param eval_data: Either a `DocumentArray` for evaluation data, a name of the</span>
<span class="sd">        `DocumentArray` that is pushed on Jina AI Cloud or a path to a CSV file.</span>
<span class="sd">    :param val_split: Determines which portion of the `train_data` is held out</span>
<span class="sd">        for calculating a validation loss. If it is set to 0, or an `eval_data`</span>
<span class="sd">        parameter is provided, no data is held out from the training data. Instead, the</span>
<span class="sd">        `eval_data` is used to calculate the validation loss if it is provided.</span>
<span class="sd">    :param model_artifact: To continue training the training of a model which was</span>
<span class="sd">        fine-tuned by a previous run, you can provide the artifact id of this model,</span>
<span class="sd">        which you can get via :meth:`Run.artifact_id`.</span>
<span class="sd">    :param run_name: Name of the run.</span>
<span class="sd">    :param description: Run description.</span>
<span class="sd">    :param experiment_name: Name of the experiment.</span>
<span class="sd">    :param model_options: Additional arguments to pass to the model construction. These</span>
<span class="sd">        are model specific options and are different depending on the model you choose.</span>
<span class="sd">        Run `finetuner.list_model_options()` to see available options for every model.</span>
<span class="sd">    :param loss: Name of the loss function used for fine-tuning. Default is</span>
<span class="sd">        `TripletMarginLoss`. Options: `CosFaceLoss`, `NTXLoss`, `AngularLoss`,</span>
<span class="sd">        `ArcFaceLoss`, `BaseMetricLossFunction`, `MultipleLosses`,</span>
<span class="sd">        `CentroidTripletLoss`, `CircleLoss`, `ContrastiveLoss`, `CrossBatchMemory`,</span>
<span class="sd">        `FastAPLoss`, `GenericPairLoss`, `IntraPairVarianceLoss`,</span>
<span class="sd">        `LargeMarginSoftmaxLoss`, `GeneralizedLiftedStructureLoss`,</span>
<span class="sd">        `LiftedStructureLoss`, `MarginLoss`, `EmbeddingRegularizerMixin`,</span>
<span class="sd">        `WeightRegularizerMixin`, `MultiSimilarityLoss`, `NPairsLoss`, `NCALoss`,</span>
<span class="sd">        `NormalizedSoftmaxLoss`, `ProxyAnchorLoss`, `ProxyNCALoss`,</span>
<span class="sd">        `SignalToNoiseRatioContrastiveLoss`, `SoftTripleLoss`, `SphereFaceLoss`,</span>
<span class="sd">        `SupConLoss`, `TripletMarginLoss`, `TupletMarginLoss`, `VICRegLoss`,</span>
<span class="sd">        `CLIPLoss`.</span>
<span class="sd">    :param miner: Name of the miner to create tuple indices for the loss function.</span>
<span class="sd">        Options: `AngularMiner`, `BaseMiner`, `BaseSubsetBatchMiner`, `BaseTupleMiner`,</span>
<span class="sd">        `BatchEasyHardMiner`, `BatchHardMiner`, `DistanceWeightedMiner`, `HDCMiner`,</span>
<span class="sd">        `EmbeddingsAlreadyPackagedAsTriplets`, `MaximumLossMiner`, `PairMarginMiner`,</span>
<span class="sd">        `MultiSimilarityMiner`, `TripletMarginMiner`, `UniformHistogramMiner`.</span>
<span class="sd">    :param miner_options: Additional parameters to pass to the miner construction. The</span>
<span class="sd">        set of applicable parameters is specific to the miner you choose. Details on</span>
<span class="sd">        the parameters can be found in the `PyTorch Metric Learning documentation</span>
<span class="sd">        &lt;https://kevinmusgrave.github.io/pytorch-metric-learning/miners/&gt;`_</span>
<span class="sd">    :param optimizer: Name of the optimizer used for fine-tuning. Options: `Adadelta`,</span>
<span class="sd">        `Adagrad`, `Adam`, `AdamW`, `SparseAdam`, `Adamax`, `ASGD`, `LBFGS`, `NAdam`,</span>
<span class="sd">        `RAdam`, `RMSprop`, `Rprop`, `SGD`.</span>
<span class="sd">    :param optimizer_options: Additional parameters to pass to the optimizer</span>
<span class="sd">        construction. The set of applicable parameters is specific to the optimizer you</span>
<span class="sd">        choose. Details on the parameters can be found in the `PyTorch documentation</span>
<span class="sd">        &lt;https://pytorch.org/docs/stable/optim.html&gt;`_</span>
<span class="sd">    :param learning_rate: learning rate for the optimizer.</span>
<span class="sd">    :param epochs: Number of epochs for fine-tuning.</span>
<span class="sd">    :param batch_size: Number of items to include in a batch. If not set, the</span>
<span class="sd">        batch size will be configured automatically.</span>
<span class="sd">    :param callbacks: List of callback stub objects.</span>
<span class="sd">        subpackage for available options, or run `finetuner.list_callbacks()`.</span>
<span class="sd">    :param scheduler: Name of a scheduler to use for learning rate scheduling.</span>
<span class="sd">        Supported types are: `linear`, `cosine`, `cosine_with_restarts`, `polynomial`,</span>
<span class="sd">        `constant`, `constant_with_warmup`.</span>
<span class="sd">    :param scheduler_options: Dictionary of additional parameters to pass to the</span>
<span class="sd">        scheduler: `num_warmup_steps`, `num_training_steps`, and `scheduler_step`</span>
<span class="sd">        (either `batch` or `epoch`).</span>
<span class="sd">    :param freeze: If set to `True`, will freeze all layers except the last one.</span>
<span class="sd">    :param output_dim: The expected output dimension as `int`.</span>
<span class="sd">        If set, will attach a projection head.</span>
<span class="sd">    :param device: Whether to use the CPU, if set to `cuda`, a Nvidia GPU will be used.</span>
<span class="sd">        otherwise use `cpu` to run a cpu job.</span>
<span class="sd">    :param num_workers: Number of CPU workers. If `cpu: False` this is the number of</span>
<span class="sd">        workers used by the dataloader.</span>
<span class="sd">    :param to_onnx: Set this parameter as `True` to convert the model to an onnx model.</span>
<span class="sd">        Please note that not all models support this. If this parameter is set, please</span>
<span class="sd">        pass `is_onnx` when making inference, e.g., when calling the `get_model`</span>
<span class="sd">        function.</span>
<span class="sd">    :param csv_options: A :class:`CSVOptions` object containing options used for</span>
<span class="sd">        reading in training and evaluation data from a CSV file, if they are</span>
<span class="sd">        provided as such.</span>
<span class="sd">    :param public: A boolean value indicates if the artifact is public. It should be</span>
<span class="sd">        set to `True` if you would like to share your fine-tuned model with others.</span>
<span class="sd">    :param num_items_per_class: How many items per class (unique labels) to include</span>
<span class="sd">        in a batch. For example, if ``batch_size`` is 20, and</span>
<span class="sd">        ``num_items_per_class`` is 4, the batch will consist of 4 items for each of</span>
<span class="sd">        the 5 classes. Batch size must be divisible by `num_items_per_class`.</span>
<span class="sd">    :param sampler: Determines which sampling method will be used if the</span>
<span class="sd">        data is labeled. Default is `auto`, meaning that the sampler,</span>
<span class="sd">        will be the default for the loss function used.</span>
<span class="sd">        Setting to `class` will result in the `ClassSampler` being used, and setting to</span>
<span class="sd">        `random` will result in the `RandomSampler` being used.</span>
<span class="sd">        If set to `random` then `num_items_per_class` is not used.</span>
<span class="sd">    :param loss_optimizer: Name of the optimizer used for fine-tuning to loss function,</span>
<span class="sd">        if it is a function that requires an optimizer. Options: `Adadelta`, `Adagrad`,</span>
<span class="sd">        `Adam`, `AdamW`, `SparseAdam`, `Adamax`, `ASGD`, `LBFGS`, `NAdam`, `RAdam`,</span>
<span class="sd">        `RMSprop`, `Rprop`, `SGD`. If left as None then optimizer specified by</span>
<span class="sd">        the `optimizer` argument will be used instead.</span>
<span class="sd">    :param loss_optimizer_options: Additional parameters to pass to the optimizer of</span>
<span class="sd">        the loss function. The set of applicable parameters is specific to the optimizer</span>
<span class="sd">        you choose. Details on the parameters can be found in the `PyTorch documentation</span>
<span class="sd">        &lt;https://pytorch.org/docs/stable/optim.html&gt;`_.</span>

<span class="sd">    .. note::</span>
<span class="sd">       Unless necessary, please stick with `device=&quot;cuda&quot;`, `cpu` training could be</span>
<span class="sd">       extremely slow and inefficient.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">create_run</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span>
        <span class="n">eval_data</span><span class="o">=</span><span class="n">eval_data</span><span class="p">,</span>
        <span class="n">val_split</span><span class="o">=</span><span class="n">val_split</span><span class="p">,</span>
        <span class="n">model_artifact</span><span class="o">=</span><span class="n">model_artifact</span><span class="p">,</span>
        <span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">experiment_name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">,</span>
        <span class="n">model_options</span><span class="o">=</span><span class="n">model_options</span><span class="p">,</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>
        <span class="n">miner</span><span class="o">=</span><span class="n">miner</span><span class="p">,</span>
        <span class="n">miner_options</span><span class="o">=</span><span class="n">miner_options</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
        <span class="n">optimizer_options</span><span class="o">=</span><span class="n">optimizer_options</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
        <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
        <span class="n">scheduler_options</span><span class="o">=</span><span class="n">scheduler_options</span><span class="p">,</span>
        <span class="n">freeze</span><span class="o">=</span><span class="n">freeze</span><span class="p">,</span>
        <span class="n">output_dim</span><span class="o">=</span><span class="n">output_dim</span><span class="p">,</span>
        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
        <span class="n">to_onnx</span><span class="o">=</span><span class="n">to_onnx</span><span class="p">,</span>
        <span class="n">csv_options</span><span class="o">=</span><span class="n">csv_options</span><span class="p">,</span>
        <span class="n">public</span><span class="o">=</span><span class="n">public</span><span class="p">,</span>
        <span class="n">num_items_per_class</span><span class="o">=</span><span class="n">num_items_per_class</span><span class="p">,</span>
        <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
        <span class="n">loss_optimizer</span><span class="o">=</span><span class="n">loss_optimizer</span><span class="p">,</span>
        <span class="n">loss_optimizer_options</span><span class="o">=</span><span class="n">loss_optimizer_options</span><span class="p">,</span>
    <span class="p">)</span>


<span class="c1"># `create_run` and `fit` do the same</span>
<span class="n">create_run</span> <span class="o">=</span> <span class="n">fit</span>


<div class="viewcode-block" id="get_run"><a class="viewcode-back" href="../../api/finetuner/#finetuner.get_run">[docs]</a><span class="k">def</span> <span class="nf">get_run</span><span class="p">(</span><span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Run</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a :class:`Run` by its name and (optional) :class:`Experiment` name.</span>

<span class="sd">    If an experiment name is not specified, we&#39;ll look for the run in the default</span>
<span class="sd">    experiment.</span>

<span class="sd">    :param run_name: Name of the :class:`Run`.</span>
<span class="sd">    :param experiment_name: Optional name of the :class:`Experiment`.</span>
<span class="sd">    :return: A :class:`Run` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span> <span class="n">experiment_name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_runs"><a class="viewcode-back" href="../../api/finetuner/#finetuner.list_runs">[docs]</a><span class="k">def</span> <span class="nf">list_runs</span><span class="p">(</span>
    <span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Run</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all created :class:`Run` inside a given :class:`Experiment`.</span>

<span class="sd">    If no :class:`Experiment` is specified, list :class:`Run` for all available</span>
<span class="sd">      :class:`Experiment`.</span>
<span class="sd">    :param experiment_name: The name of the :class:`Experiment`.</span>
<span class="sd">    :param page: The page index.</span>
<span class="sd">    :param size: Number of :class:`Run` to retrieve.</span>
<span class="sd">    :return: List of all :class:`Run`.</span>

<span class="sd">    ..note:: `page` and `size` works together. For example, page 1 size 50 gives</span>
<span class="sd">        the 50 runs in the first page. To get 50-100, set `page` as 2.</span>
<span class="sd">    ..note:: The maximum number for `size` per page is 100.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">list_runs</span><span class="p">(</span><span class="n">experiment_name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_run"><a class="viewcode-back" href="../../api/finetuner/#finetuner.delete_run">[docs]</a><span class="k">def</span> <span class="nf">delete_run</span><span class="p">(</span><span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a :class:`Run` given a `run_name` and</span>
<span class="sd">        optional `experiment_name`.</span>

<span class="sd">    If an experiment name is not specified, we&#39;ll look for the run in the default</span>
<span class="sd">    experiment.</span>

<span class="sd">    :param run_name: Name of the run. View your runs with `list_runs`.</span>
<span class="sd">    :param experiment_name: Optional name of the experiment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">delete_run</span><span class="p">(</span><span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span> <span class="n">experiment_name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_runs"><a class="viewcode-back" href="../../api/finetuner/#finetuner.delete_runs">[docs]</a><span class="k">def</span> <span class="nf">delete_runs</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all :class:`Run` given an optional `experiment_name`.</span>

<span class="sd">    If an experiment name is not specified, we&#39;ll delete every run across all</span>
<span class="sd">    experiments.</span>

<span class="sd">    :param experiment_name: Optional name of the experiment.</span>
<span class="sd">        View your experiment names with `list_experiments()`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">delete_runs</span><span class="p">(</span><span class="n">experiment_name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_experiment"><a class="viewcode-back" href="../../api/finetuner/#finetuner.create_experiment">[docs]</a><span class="k">def</span> <span class="nf">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an :class:`Experiment`.</span>

<span class="sd">    :param name: The name of the experiment. If not provided,</span>
<span class="sd">        the experiment is named as `default`.</span>
<span class="sd">    :return: An `Experiment` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_experiment"><a class="viewcode-back" href="../../api/finetuner/#finetuner.get_experiment">[docs]</a><span class="k">def</span> <span class="nf">get_experiment</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an :class:`Experiment` given a `name`.</span>

<span class="sd">    :param name: Name of the experiment.</span>
<span class="sd">    :return: An `Experiment` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_experiments"><a class="viewcode-back" href="../../api/finetuner/#finetuner.list_experiments">[docs]</a><span class="k">def</span> <span class="nf">list_experiments</span><span class="p">(</span><span class="n">page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all :class:`Experiment`.</span>

<span class="sd">    :param page: The page index.</span>
<span class="sd">    :param size: The number of experiments to retrieve.</span>
<span class="sd">    :return: A list of :class:`Experiment` instance.</span>

<span class="sd">    ..note:: `page` and `size` works together. For example, page 1 size 50 gives</span>
<span class="sd">        the 50 experiments in the first page. To get 50-100, set `page` as 2.</span>
<span class="sd">    ..note:: The maximum number for `size` per page is 100.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">list_experiments</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_experiment"><a class="viewcode-back" href="../../api/finetuner/#finetuner.delete_experiment">[docs]</a><span class="k">def</span> <span class="nf">delete_experiment</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete an :class:`Experiment` given a `name`.</span>

<span class="sd">    :param name: Name of the experiment.</span>
<span class="sd">        View your experiment names with `list_experiments()`.</span>
<span class="sd">    :return: Deleted experiment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">delete_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_experiments"><a class="viewcode-back" href="../../api/finetuner/#finetuner.delete_experiments">[docs]</a><span class="k">def</span> <span class="nf">delete_experiments</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all :class:`Experiment`.</span>
<span class="sd">    :return: List of deleted experiments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">delete_experiments</span><span class="p">()</span></div>


<div class="viewcode-block" id="get_token"><a class="viewcode-back" href="../../api/finetuner/#finetuner.get_token">[docs]</a><span class="k">def</span> <span class="nf">get_token</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get user token from the Jina AI Cloud, :meth:`login` is required.</span>

<span class="sd">    :return: user token as string object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ft</span><span class="o">.</span><span class="n">get_token</span><span class="p">()</span></div>


<div class="viewcode-block" id="build_model"><a class="viewcode-back" href="../../api/finetuner/#finetuner.build_model">[docs]</a><span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">select_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_onnx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;InferenceEngine&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a pre-trained model given a `name`.</span>

<span class="sd">    :param name: Refers to a pre-trained model, see</span>
<span class="sd">        https://finetuner.jina.ai/walkthrough/choose-backbone/  or use the</span>
<span class="sd">        :meth:`finetuner.describe_models()` function for a list of all</span>
<span class="sd">        supported models.</span>
<span class="sd">    :param model_options: A dictionary of model specific options.</span>
<span class="sd">    :param batch_size: Incoming documents are fed to the graph in batches, both to</span>
<span class="sd">        speed-up inference and avoid memory errors. This argument controls the</span>
<span class="sd">        number of documents that will be put in each batch.</span>
<span class="sd">    :param select_model: Finetuner run artifacts might contain multiple models. In</span>
<span class="sd">        such cases you can select which model to deploy using this argument. For CLIP</span>
<span class="sd">        fine-tuning, you can choose either `clip-vision` or `clip-text`.</span>
<span class="sd">    :param device: Whether to use the CPU, if set to `cuda`, a Nvidia GPU will be used.</span>
<span class="sd">        otherwise use `cpu` to run a cpu job.</span>
<span class="sd">    :param is_onnx: The model output format, either `onnx` or `pt`.</span>
<span class="sd">    :return: an instance of :class:&#39;TorchInferenceEngine&#39; or</span>
<span class="sd">        :class:`ONNXINferenceEngine`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">torch</span>
    <span class="kn">from</span> <span class="nn">_finetuner.models.inference</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">ONNXRuntimeInferenceEngine</span><span class="p">,</span>
        <span class="n">TorchInferenceEngine</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="kn">from</span> <span class="nn">_finetuner.runner.model</span> <span class="kn">import</span> <span class="n">RunnerModel</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">device</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>

    <span class="n">stub</span> <span class="o">=</span> <span class="n">model_stub</span><span class="o">.</span><span class="n">get_stub</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">select_model</span><span class="o">=</span><span class="n">select_model</span><span class="p">,</span> <span class="n">model_options</span><span class="o">=</span><span class="n">model_options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">RunnerModel</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="n">stub</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_onnx</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TorchInferenceEngine</span><span class="p">(</span>
            <span class="n">artifact</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ONNXRuntimeInferenceEngine</span><span class="p">(</span>
            <span class="n">artifact</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="get_model"><a class="viewcode-back" href="../../api/finetuner/#finetuner.get_model">[docs]</a><span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">select_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span>
    <span class="n">is_onnx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;InferenceEngine&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Re-build the model based on the model inference session with ONNX.</span>

<span class="sd">    :param artifact: Specify a finetuner run artifact. Can be a path to a local</span>
<span class="sd">        directory, a path to a local zip file, or a Hubble artifact ID. Individual</span>
<span class="sd">        model artifacts (model sub-folders inside the run artifacts) can also be</span>
<span class="sd">        specified using this argument.</span>
<span class="sd">    :param token: A Jina authentication token required for pulling artifacts from</span>
<span class="sd">        Hubble. If not provided, the Hubble client will try to find one either in a</span>
<span class="sd">        local cache folder or in the environment.</span>
<span class="sd">    :param batch_size: Incoming documents are fed to the graph in batches, both to</span>
<span class="sd">        speed-up inference and avoid memory errors. This argument controls the</span>
<span class="sd">        number of documents that will be put in each batch.</span>
<span class="sd">    :param select_model: Finetuner run artifacts might contain multiple models. In</span>
<span class="sd">        such cases you can select which model to deploy using this argument. For CLIP</span>
<span class="sd">        fine-tuning, you can choose either `clip-vision` or `clip-text`.</span>
<span class="sd">    :param device: Whether to use the CPU, if set to `cuda`, a Nvidia GPU will be used.</span>
<span class="sd">        otherwise use `cpu` to run a cpu job.</span>
<span class="sd">    :param logging_level: The executor logging level. See</span>
<span class="sd">        https://docs.python.org/3/library/logging.html#logging-levels for available</span>
<span class="sd">        options.</span>
<span class="sd">    :param is_onnx: The model output format, either `onnx` or `pt`.</span>
<span class="sd">    :returns: An instance of :class:`ONNXRuntimeInferenceEngine`.</span>

<span class="sd">    ..Note::</span>
<span class="sd">      please install finetuner[full] to include all the dependencies.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">torch</span>
    <span class="kn">from</span> <span class="nn">_finetuner.models.inference</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">ONNXRuntimeInferenceEngine</span><span class="p">,</span>
        <span class="n">TorchInferenceEngine</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">device</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>

    <span class="k">if</span> <span class="n">device</span> <span class="o">==</span> <span class="s1">&#39;cuda&#39;</span> <span class="ow">and</span> <span class="n">is_onnx</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s1">&#39;You are using cuda device for ONNX inference, please consider&#39;</span>
            <span class="s1">&#39;calling `pip install onnxruntime-gpu` to speed up inference.&#39;</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_onnx</span><span class="p">:</span>
        <span class="n">inference_engine</span> <span class="o">=</span> <span class="n">ONNXRuntimeInferenceEngine</span><span class="p">(</span>
            <span class="n">artifact</span><span class="o">=</span><span class="n">artifact</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">select_model</span><span class="o">=</span><span class="n">select_model</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">logging_level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inference_engine</span> <span class="o">=</span> <span class="n">TorchInferenceEngine</span><span class="p">(</span>
            <span class="n">artifact</span><span class="o">=</span><span class="n">artifact</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">select_model</span><span class="o">=</span><span class="n">select_model</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">logging_level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">inference_engine</span></div>


<div class="viewcode-block" id="encode"><a class="viewcode-back" href="../../api/finetuner/#finetuner.encode">[docs]</a><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;InferenceEngine&#39;</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DocumentArray</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DocumentArray</span><span class="p">,</span> <span class="s1">&#39;np.ndarray&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocess, collate and encode the `list or :class:`DocumentArray`</span>
<span class="sd">        with embeddings.</span>

<span class="sd">    :param model: The model to be used to encode `DocumentArray`. In this case</span>
<span class="sd">        an instance of `ONNXRuntimeInferenceEngine` or `TorchInferenceEngine`</span>
<span class="sd">        produced by :meth:`finetuner.get_model()`</span>
<span class="sd">    :param data: The `DocumentArray` object to be encoded.</span>
<span class="sd">    :param batch_size: Incoming documents are fed to the graph in batches, both to</span>
<span class="sd">        speed-up inference and avoid memory errors. This argument controls the</span>
<span class="sd">        number of documents that will be put in each batch.</span>
<span class="sd">    :returns: `DocumentArray` filled with embeddings.</span>

<span class="sd">    ..Note::</span>
<span class="sd">      please install &quot;finetuner[full]&quot; to include all the dependencies.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">_finetuner.models.inference</span> <span class="kn">import</span> <span class="n">ONNXRuntimeInferenceEngine</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">):</span>
        <span class="n">return_da</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">build_encoding_dataset</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">return_da</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ONNXRuntimeInferenceEngine</span><span class="p">):</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_run_data_pipeline</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_flatten_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_check_input_names</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">output_shape</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_infer_output_shape</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_move_to_device</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">output_shape</span><span class="p">)</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_run_data_pipeline</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_flatten_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_check_input_names</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_move_to_device</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span> <span class="k">if</span> <span class="n">return_da</span> <span class="k">else</span> <span class="n">data</span><span class="o">.</span><span class="n">embeddings</span></div>
</pre></div>
                </article>
            </div>
            <footer>
                
                <div class="related-pages">
                    
                    
                </div>
                <div class="bottom-of-page">
                    <div class="left-details">
                        <div class="copyright">
                            Copyright &#169; Jina AI Limited. All rights reserved.
                        </div><div class="last-updated">
                            Last updated on Mar 16, 2023</div>
                    </div>
                    <div class="right-details">
                        <div class="social-btns">
                            <a class='social-btn' href="https://github.com/jina-ai/finetuner/" aria-label="GitHub"
                               target="_blank" rel="noreferrer"> <i class="fab fa-github"></i></a>
                            <a class='social-btn' href="https://slack.jina.ai" aria-label="Slack" target="_blank"
                               rel="noreferrer"> <i class="fab fa-slack"></i></a>
                            <a class='social-btn' href="https://youtube.com/c/jina-ai" aria-label="YouTube"
                               target="_blank" rel="noreferrer"> <i class="fab fa-youtube"></i></a>
                            <a class='social-btn' href="https://twitter.com/JinaAI_" aria-label="Twitter"
                               target="_blank" rel="noreferrer"> <i class="fab fa-twitter"></i></a>
                            <a class='social-btn' href="https://www.linkedin.com/company/jinaai/" aria-label="LinkedIn"
                               target="_blank" rel="noreferrer"> <i class="fab fa-linkedin"></i></a>
                        </div>
                    </div>
                </div>
                
            </footer>
        </div>
        <aside class="toc-drawer no-toc">
            
            
            
        </aside>

        <qa-bot
            token="vizI4XaM1li8kQW2kQOiiBjtk02hzBDl0Em8lBjpzAKsjhX_z03mix_i3wKpiA=="
            theme="infer"
            target="_self"
            orientation="bottom-right"
            title="Finetuner"
            description="Task-oriented finetuning for better embeddings on neural search"
            show-tip>
          <template>
            <dl>
             <dt>You can ask questions about our docs. Try:</dt>
             <dd>What is Finetuner?</dd>
             <dd>How does Finetuner Work?</dd>
             <dd>What makes Finetuner unique?</dd>
            </dl>
          </template>
          <template slot="texts">
            <span for="tip">Hi there 
         Ask our docs!</span>
            <span for="unknownAnswerText"> I'm sorry but I don't know the answer.</span>
          </template>
        </qa-bot>
</div>
<img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=e0caedb8-a833-4e85-983d-d3394a5f16d2" /><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qabot"></script>
    <script src="../../_static/source-in-links.js"></script>
    </body>
</html>